

# Example configuration entry
#web_server:
#  port: 80


# Enable logging
logger:
  level: DEBUG


uart:
  id: uart_bus
  rx_pin: ${rx_pin}
#  tx_pin: ${tx_pin}
  baud_rate: 9600
  data_bits: 8
  parity: NONE
  stop_bits: 1
  rx_buffer_size: 512


text_sensor:
  - platform: template
    name: "BMS Raw Data"
    id: bms_raw_data

# У секції uart:
    lambda: |-
      static std::string buffer;
      while (id(uart_bus).available()) {
        uint8_t b;
        id(uart_bus).read_byte(&b);
        
        // Додаємо байт у форматі HEX до рядка
        char temp[4];
        sprintf(temp, "%02X ", b);
        buffer += temp;

        // Коли назбирали достатньо для одного рядка (наприклад, 20 байт)
        if (buffer.length() > 60) { 
          id(bms_raw_data).publish_state(buffer);
          buffer.clear();
        }
      }
      return {"Streaming to HA"};
